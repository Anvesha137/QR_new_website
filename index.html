<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quickrevert Website Design</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <style>
      /* Custom styles for n8n chat widget */
      #n8n-chat-button {
        font-family: 'Montserrat', sans-serif !important;
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
        border: none;
        border-radius: 50px;
        padding: 12px 24px;
        background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);
        color: white;
        font-weight: 600;
        font-size: 14px;
        cursor: pointer;
        box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
      }
      
      #n8n-chat-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(99, 102, 241, 0.4);
      }
      
      #n8n-chat-button:active {
        transform: translateY(0);
      }
      
      /* Custom chat container styling */
      #n8n-chat-container {
        position: fixed;
        bottom: 80px;
        right: 20px;
        width: 380px;
        height: 500px;
        z-index: 1000;
        font-family: 'Montserrat', sans-serif !important;
        display: none;
      }
      
      #n8n-chat-container.active {
        display: block;
      }
      
      /* Chat window styling */
      #n8n-chat {
        background: white;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        height: 100%;
        display: flex;
        flex-direction: column;
        border: 1px solid #e2e8f0;
      }
      
      /* Chat header */
      .n8n-chat-header {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        color: white;
        padding: 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      .n8n-chat-header__title {
        font-family: 'Montserrat', sans-serif !important;
        font-weight: 600;
        font-size: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      
      .n8n-chat-header__close {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        font-size: 20px;
        padding: 0;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: background 0.2s;
      }
      
      .n8n-chat-header__close:hover {
        background: rgba(255, 255, 255, 0.1);
      }
      
      /* Chat messages container */
      .n8n-chat-messages {
        flex: 1;
        padding: 16px;
        overflow-y: auto;
        background: #f8fafc;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      
      /* Chat message styling */
      .n8n-chat-message {
        display: flex;
        gap: 12px;
        max-width: 85%;
      }
      
      .n8n-chat-message--user {
        align-self: flex-end;
      }
      
      .n8n-chat-message__avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 14px;
      }
      
      .n8n-chat-message--bot .n8n-chat-message__avatar {
        background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);
        color: white;
      }
      
      .n8n-chat-message--user .n8n-chat-message__avatar {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        color: white;
      }
      
      .n8n-chat-message__content {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      
      .n8n-chat-message__bubble {
        padding: 12px 16px;
        border-radius: 18px;
        font-family: 'Montserrat', sans-serif !important;
        font-size: 14px;
        line-height: 1.4;
        position: relative;
      }
      
      .n8n-chat-message--bot .n8n-chat-message__bubble {
        background: white;
        color: #334155;
        border: 1px solid #e2e8f0;
        border-top-left-radius: 4px;
      }
      
      .n8n-chat-message--user .n8n-chat-message__bubble {
        background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);
        color: white;
        border-bottom-right-radius: 4px;
      }
      
      .n8n-chat-message__timestamp {
        font-family: 'Montserrat', sans-serif !important;
        font-size: 10px;
        color: #94a3b8;
        margin-top: 2px;
      }
      
      .n8n-chat-message--user .n8n-chat-message__timestamp {
        color: #c7d2fe;
        text-align: right;
      }
      
      /* Chat input styling */
      .n8n-chat-input {
        padding: 16px;
        background: white;
        border-top: 1px solid #e2e8f0;
        display: flex;
        gap: 8px;
      }
      
      .n8n-chat-input__field {
        flex: 1;
        padding: 12px 16px;
        border: 1px solid #e2e8f0;
        border-radius: 24px;
        font-family: 'Montserrat', sans-serif !important;
        font-size: 14px;
        outline: none;
        transition: border-color 0.2s;
      }
      
      .n8n-chat-input__field:focus {
        border-color: #6366f1;
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }
      
      .n8n-chat-input__button {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);
        border: none;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: transform 0.2s;
      }
      
      .n8n-chat-input__button:hover {
        transform: scale(1.05);
      }
      
      .n8n-chat-input__button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }
      
      /* Welcome message styling */
      .n8n-chat-welcome {
        text-align: center;
        padding: 24px 16px;
        background: white;
        border-radius: 12px;
        margin-bottom: 16px;
        border: 1px solid #e2e8f0;
      }
      
      .n8n-chat-welcome__title {
        font-family: 'Montserrat', sans-serif !important;
        font-weight: 600;
        font-size: 18px;
        color: #0f172a;
        margin-bottom: 8px;
      }
      
      .n8n-chat-welcome__message {
        font-family: 'Montserrat', sans-serif !important;
        font-size: 14px;
        color: #64748b;
        line-height: 1.5;
        margin-bottom: 16px;
      }
      
      /* Loading indicator */
      .n8n-chat-loading {
        display: inline-block;
        width: 24px;
        height: 24px;
        border: 3px solid rgba(99, 102, 241, 0.3);
        border-radius: 50%;
        border-top-color: #6366f1;
        animation: spin 1s ease-in-out infinite;
      }
      
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      
      /* Scrollbar styling */
      .n8n-chat-messages::-webkit-scrollbar {
        width: 6px;
      }
      
      .n8n-chat-messages::-webkit-scrollbar-track {
        background: #f1f5f9;
      }
      
      .n8n-chat-messages::-webkit-scrollbar-thumb {
        background: #c7d2fe;
        border-radius: 3px;
      }
      
      .n8n-chat-messages::-webkit-scrollbar-thumb:hover {
        background: #6366f1;
      }
      
      /* Menu chat styles */
      #menu-chat-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(99, 102, 241, 0.4);
      }
      
      #menu-chat-button:active {
        transform: translateY(0);
      }
      
      /* Menu chat container styling */
      #menu-chat-container.active {
        display: block;
      }
      
      /* Menu chat window styling */
      #menu-chat {
        background: white;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        height: 100%;
        display: flex;
        flex-direction: column;
        border: 1px solid #e2e8f0;
      }
      
      /* Menu chat header */
      .menu-chat-header {
        background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);
        color: white;
        padding: 16px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      .menu-chat-header__title {
        font-family: 'Montserrat', sans-serif !important;
        font-weight: 600;
        font-size: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      
      .menu-chat-header__close {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        font-size: 20px;
        padding: 0;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: background 0.2s;
      }
      
      .menu-chat-header__close:hover {
        background: rgba(255, 255, 255, 0.1);
      }
      
      /* Menu chat messages container */
      .menu-chat-messages {
        flex: 1;
        padding: 16px;
        overflow-y: auto;
        background: #f8fafc;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      
      /* Menu chat message styling */
      .menu-chat-message {
        display: flex;
        gap: 12px;
        max-width: 85%;
      }
      
      .menu-chat-message__content {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      
      .menu-chat-message__bubble {
        padding: 12px 16px;
        border-radius: 18px;
        font-family: 'Montserrat', sans-serif !important;
        font-size: 14px;
        line-height: 1.4;
        position: relative;
        background: white;
        color: #334155;
        border: 1px solid #e2e8f0;
        border-top-left-radius: 4px;
      }
      
      .menu-chat-message__timestamp {
        font-family: 'Montserrat', sans-serif !important;
        font-size: 10px;
        color: #94a3b8;
        margin-top: 2px;
      }
      
      /* Welcome message styling */
      .menu-chat-welcome {
        text-align: center;
        padding: 16px;
        background: white;
        border-radius: 12px;
        margin-bottom: 16px;
        border: 1px solid #e2e8f0;
      }
      
      .menu-chat-welcome__title {
        font-family: 'Montserrat', sans-serif !important;
        font-weight: 600;
        font-size: 18px;
        color: #0f172a;
        margin-bottom: 8px;
      }
      
      .menu-chat-welcome__message {
        font-family: 'Montserrat', sans-serif !important;
        font-size: 14px;
        color: #64748b;
        line-height: 1.5;
        margin-bottom: 16px;
      }
      
      /* Menu options */
      .menu-options {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      
      .menu-option {
        background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);
        color: white;
        border: none;
        border-radius: 24px;
        padding: 12px 20px;
        font-family: 'Montserrat', sans-serif !important;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        text-align: left;
        transition: all 0.2s ease;
        box-shadow: 0 2px 4px rgba(99, 102, 241, 0.2);
      }
      
      .menu-option:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(99, 102, 241, 0.3);
      }
      
      /* Calendar button */
      .calendar-button {
        background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
        color: white;
        border: none;
        border-radius: 24px;
        padding: 12px 20px;
        font-family: 'Montserrat', sans-serif !important;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        text-align: center;
        transition: all 0.2s ease;
        box-shadow: 0 2px 4px rgba(74, 222, 128, 0.2);
        margin: 10px 0;
        display: block;
        width: 100%;
      }
      
      .calendar-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(74, 222, 128, 0.3);
      }
      
      /* Back button */
      .back-button {
        background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
        color: white;
        border: none;
        border-radius: 24px;
        padding: 12px 20px;
        font-family: 'Montserrat', sans-serif !important;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        text-align: center;
        transition: all 0.2s ease;
        box-shadow: 0 2px 4px rgba(148, 163, 184, 0.2);
        margin: 10px 0;
        display: block;
        width: 100%;
      }
      
      .back-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(148, 163, 184, 0.3);
      }
      
      /* Scrollbar styling for menu chat */
      .menu-chat-messages::-webkit-scrollbar {
        width: 6px;
      }
      
      .menu-chat-messages::-webkit-scrollbar-track {
        background: #f1f5f9;
      }
      
      .menu-chat-messages::-webkit-scrollbar-thumb {
        background: #c7d2fe;
        border-radius: 3px;
      }
      
      .menu-chat-messages::-webkit-scrollbar-thumb:hover {
        background: #6366f1;
      }
    </style>
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script type="module">
      // Custom chat implementation with n8n webhook
      document.addEventListener('DOMContentLoaded', function() {
        // Create chat button
        const chatButton = document.createElement('button');
        chatButton.id = 'n8n-chat-button';
        chatButton.innerHTML = `
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          </svg>
          Chat with us
        `;
        document.body.appendChild(chatButton);
        
        // Create chat container
        const chatContainer = document.createElement('div');
        chatContainer.id = 'n8n-chat-container';
        chatContainer.innerHTML = `
          <div id="n8n-chat">
            <div class="n8n-chat-header">
              <div class="n8n-chat-header__title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                Quickrevert Assistant
              </div>
              <button class="n8n-chat-header__close">&times;</button>
            </div>
            <div class="n8n-chat-messages">
              <div class="n8n-chat-welcome">
                <h3 class="n8n-chat-welcome__title">Welcome to Quickrevert!</h3>
                <p class="n8n-chat-welcome__message">I'm your AI assistant ready to help you with any questions about our chatbot solutions.</p>
              </div>
            </div>
            <div class="n8n-chat-input">
              <input type="text" class="n8n-chat-input__field" placeholder="Type your message here..." />
              <button class="n8n-chat-input__button">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="22" y1="2" x2="11" y2="13"></line>
                  <polygon points="22,2 15,22 11,13 2,9 22,2"></polygon>
                </svg>
              </button>
            </div>
          </div>
        `;
        document.body.appendChild(chatContainer);
        
        // Chat functionality
        const toggleChat = () => {
          chatContainer.classList.toggle('active');
        };
        
        const closeChat = () => {
          chatContainer.classList.remove('active');
        };
        
        chatButton.addEventListener('click', toggleChat);
        document.querySelector('.n8n-chat-header__close').addEventListener('click', closeChat);
        
        // Handle sending messages to n8n webhook
        const inputField = document.querySelector('.n8n-chat-input__field');
        const sendButton = document.querySelector('.n8n-chat-input__button');
        const messagesContainer = document.querySelector('.n8n-chat-messages');
        
        // Function to add a message to the chat
        const addMessage = (message, isUser = false) => {
          const messageElement = document.createElement('div');
          messageElement.className = `n8n-chat-message n8n-chat-message--${isUser ? 'user' : 'bot'}`;
          messageElement.innerHTML = `
            <div class="n8n-chat-message__avatar">${isUser ? 'U' : 'Q'}</div>
            <div class="n8n-chat-message__content">
              <div class="n8n-chat-message__bubble">
                ${message}
              </div>
              <div class="n8n-chat-message__timestamp">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
            </div>
          `;
          messagesContainer.appendChild(messageElement);
          messagesContainer.scrollTop = messagesContainer.scrollHeight;
        };
        
        // Function to send message to n8n webhook
        const sendToWebhook = async (message, isInitial = false) => {
          // Show typing indicator
          const typingIndicator = document.createElement('div');
          typingIndicator.className = 'n8n-chat-message n8n-chat-message--bot';
          typingIndicator.id = 'typing-indicator';
          typingIndicator.innerHTML = `
            <div class="n8n-chat-message__avatar">Q</div>
            <div class="n8n-chat-message__content">
              <div class="n8n-chat-message__bubble">
                <div class="n8n-chat-loading"></div>
              </div>
            </div>
          `;
          messagesContainer.appendChild(typingIndicator);
          messagesContainer.scrollTop = messagesContainer.scrollHeight;
          
          try {
            // Send message to n8n webhook with retry logic
            let webhookUrl = import.meta.env.VITE_N8N_WEBHOOK_URL;
            
            // Fallback to direct URL if environment variable is not available
            if (!webhookUrl) {
              console.warn('Webhook URL not found in environment variables, using fallback URL');
              webhookUrl = 'https://n8n.quickrevert.tech/webhook/bf4dd093-bb02-472c-9454-7ab9af97bd1d';
            }
            
            // Final check if webhook URL is properly loaded
            if (!webhookUrl) {
              console.error('Webhook URL not found in environment variables');
              console.error('Available environment variables:', import.meta.env);
              throw new Error('Webhook URL not found. Please check your environment configuration.');
            }
            
            // Log the webhook URL for debugging (remove in production)
            console.log('Sending request to webhook:', webhookUrl);
            console.log('Request payload:', {
              message: message,
              timestamp: new Date().toISOString()
            });
            
            // Retry logic - attempt up to 3 times
            let lastError;
            let response;
            
            for (let attempt = 1; attempt <= 3; attempt++) {
              try {
                // Add timeout to fetch request
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 30000); // 30 second timeout
                
                response = await fetch(webhookUrl, {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                  },
                  body: JSON.stringify({
                    // Simplified payload that n8n webhooks typically expect
                    webhookData: {
                      message: message,
                      timestamp: new Date().toISOString()
                    },
                    message: message,
                    text: message,
                    timestamp: new Date().toISOString()
                  }),
                  signal: controller.signal,
                });
                
                clearTimeout(timeoutId);
                
                // If successful, break out of retry loop
                if (response.ok) {
                  console.log(`Request succeeded on attempt ${attempt}`);
                  break;
                } else {
                  console.warn(`Attempt ${attempt} failed with status ${response.status}`);
                  lastError = new Error(`HTTP error! status: ${response.status}`);
                  
                  // Don't retry on client errors (4xx), only on server errors (5xx) or network issues
                  if (response.status >= 400 && response.status < 500) {
                    break;
                  }
                  
                  // Wait before retrying (exponential backoff)
                  if (attempt < 3) {
                    await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
                  }
                }
              } catch (error) {
                console.warn(`Attempt ${attempt} failed with error:`, error);
                lastError = error;
                
                // Wait before retrying (exponential backoff)
                if (attempt < 3) {
                  await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
                }
              }
            }
            
            // If all attempts failed, throw the last error
            if (!response || !response.ok) {
              throw lastError || new Error('All retry attempts failed');
            }
            
            console.log('Response status:', response.status);
            console.log('Response headers:', [...response.headers.entries()]);
            
            // Log response text for debugging
            const responseClone = response.clone();
            const responseTextDebug = await responseClone.text();
            console.log('Response text:', responseTextDebug);
            
            // Remove typing indicator
            typingIndicator.remove();
            
            let responseText = '';
            
            if (!response.ok) {
              // If response is not OK, try to get error message
              try {
                const errorData = await response.json();
                responseText = errorData.message || errorData.error || `HTTP error! status: ${response.status}`;
              } catch (e) {
                responseText = `HTTP error! status: ${response.status}`;
              }
            } else {
              // Try to parse response as JSON
              try {
                const data = await response.json();
                
                // Extract and display only the output field from n8n response
                if (typeof data === 'string') {
                  responseText = data;
                } else if (data && typeof data === 'object' && data.output) {
                  responseText = data.output;
                } else {
                  // If no output field, display the full response as string
                  responseText = JSON.stringify(data, null, 2);
                }
              } catch (e) {
                // If not JSON, get as text
                responseText = await response.text();
              }
            }
            
            // Add bot response
            addMessage(responseText);
          } catch (error) {
            console.error('Error sending message to n8n:', error);
            
            // Remove typing indicator
            typingIndicator.remove();
            
            // Show more detailed error message
            let errorMessage = "Sorry, I'm having trouble connecting to our chat service. Please try again in a moment.";
            if (error instanceof TypeError && error.message.includes('fetch')) {
              errorMessage = "I'm having trouble connecting to our chat service. Please check your internet connection and try again.";
            } else if (error.name === 'AbortError') {
              errorMessage = "Sorry, our chat service is taking longer than expected to respond. Please try again.";
            } else if (error.message) {
              errorMessage = "Sorry, something went wrong. Please try again in a moment.";
            }
            
            // Add suggestion for alternative contact
            errorMessage += " If this continues, please email us at support@quickrevert.com.";
            
            // Show error message only if it's not the initial message
            if (!isInitial) {
              addMessage(errorMessage);
            }
          }
        };
        
        // Send initial message when chat opens
        const sendInitialMessage = () => {
          // Add the predefined welcome message
          addMessage("Hello, I am Quickrevert! How can I help you today?");
        };
        
        const sendMessage = async () => {
          const message = inputField.value.trim();
          if (!message) return;
          
          // Add user message
          addMessage(message, true);
          
          // Clear input
          inputField.value = '';
          
          // Send to webhook
          sendToWebhook(message);
        };
        
        sendButton.addEventListener('click', sendMessage);
        
        inputField.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            sendMessage();
          }
        });
        
        // Automatically open chat on page load and send initial message
        setTimeout(() => {
          chatContainer.classList.add('active');
          // Delay initial message to ensure UI is ready
          setTimeout(sendInitialMessage, 500);
        }, 1000);
      
        // Create menu-driven chat button
        const menuChatButton = document.createElement('button');
        menuChatButton.id = 'menu-chat-button';
        menuChatButton.innerHTML = `
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          </svg>
          QuickRevert AI
        `;
        menuChatButton.style.position = 'fixed';
        menuChatButton.style.bottom = '20px';
        menuChatButton.style.right = '200px';
        menuChatButton.style.zIndex = '1000';
        menuChatButton.style.border = 'none';
        menuChatButton.style.borderRadius = '50px';
        menuChatButton.style.padding = '12px 24px';
        menuChatButton.style.background = 'linear-gradient(135deg, #6366f1 0%, #818cf8 100%)';
        menuChatButton.style.color = 'white';
        menuChatButton.style.fontWeight = '600';
        menuChatButton.style.fontSize = '14px';
        menuChatButton.style.cursor = 'pointer';
        menuChatButton.style.boxShadow = '0 4px 12px rgba(99, 102, 241, 0.3)';
        menuChatButton.style.display = 'flex';
        menuChatButton.style.alignItems = 'center';
        menuChatButton.style.gap = '8px';
        menuChatButton.style.transition = 'all 0.3s ease';
        document.body.appendChild(menuChatButton);
      
        // Create menu chat container
        const menuChatContainer = document.createElement('div');
        menuChatContainer.id = 'menu-chat-container';
        menuChatContainer.innerHTML = `
          <div id="menu-chat">
            <div class="menu-chat-header">
              <div class="menu-chat-header__title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                QuickRevert AI
              </div>
              <button class="menu-chat-header__close">&times;</button>
            </div>
            <div class="menu-chat-messages">
              <div class="menu-chat-welcome">
                <h3 class="menu-chat-welcome__title">Welcome to QuickRevert Assistant!</h3>
                <p class="menu-chat-welcome__message">Hey ğŸ‘‹ Welcome to QuickRevert Assistant! How can I help you today?</p>
                <div class="menu-options">
                  <button class="menu-option">ğŸ“… Book a Meeting / Demo</button>
                  <button class="menu-option">ğŸ’¡ About Our Services</button>
                  <button class="menu-option">ğŸ¢ Industry Use Cases</button>
                  <button class="menu-option">ğŸ“ˆ Why Businesses Choose QuickRevert</button>
                  <button class="menu-option">ğŸ†˜ Get Support or Learn More</button>
                </div>
              </div>
            </div>
          </div>
        `;
        menuChatContainer.style.position = 'fixed';
        menuChatContainer.style.bottom = '80px';
        menuChatContainer.style.right = '20px';
        menuChatContainer.style.width = '380px';
        menuChatContainer.style.height = '500px';
        menuChatContainer.style.zIndex = '1000';
        menuChatContainer.style.fontFamily = "'Montserrat', sans-serif";
        menuChatContainer.style.display = 'none';
        document.body.appendChild(menuChatContainer);
      
        // Menu chat functionality
        const toggleMenuChat = () => {
          menuChatContainer.style.display = menuChatContainer.style.display === 'none' ? 'block' : 'none';
        };
      
        const closeMenuChat = () => {
          menuChatContainer.style.display = 'none';
        };
      
        menuChatButton.addEventListener('click', toggleMenuChat);
        document.querySelector('.menu-chat-header__close').addEventListener('click', closeMenuChat);
      
        // Handle menu options
        document.querySelectorAll('.menu-option').forEach(button => {
          button.addEventListener('click', function() {
            const optionText = this.textContent;
            handleMenuOption(optionText);
          });
        });
      
        // Handle menu option selection
        const handleMenuOption = (option) => {
          const messagesContainer = document.querySelector('.menu-chat-messages');
              
          // Clear previous options
          const optionsContainer = document.querySelector('.menu-options');
          if (optionsContainer) {
            optionsContainer.remove();
          }
              
          // Add user's selection as a message
          const userMessageElement = document.createElement('div');
          userMessageElement.className = 'menu-chat-message';
          userMessageElement.innerHTML = `
            <div class="menu-chat-message__content" style="align-self: flex-end;">
              <div class="menu-chat-message__bubble" style="background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%); color: white; border: none; border-bottom-right-radius: 4px;">
                ${option}
              </div>
              <div class="menu-chat-message__timestamp" style="color: #c7d2fe; text-align: right;">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
            </div>
          `;
          messagesContainer.appendChild(userMessageElement);
              
          let responseText = '';
          let newOptions = [];
              
          switch(option) {
            case 'ğŸ“… Book a Meeting / Demo':
              responseText = `You can schedule a meeting or demo with our team directly below ğŸ‘‡`;
              
              // Add response message
              const responseElement = document.createElement('div');
              responseElement.className = 'menu-chat-message';
              responseElement.innerHTML = `
                <div class="menu-chat-message__content">
                  <div class="menu-chat-message__bubble">
                    ${responseText.replace(/\n/g, '<br>')}
                  </div>
                  <div class="menu-chat-message__timestamp">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
                </div>
              `;
              messagesContainer.appendChild(responseElement);
              
              // Create a calendar button
              const googleCalendarUrl = 'https://calendar.app.google/vxx53dF3chEmrwtV8';
              const calendarButton = document.createElement('button');
              calendarButton.className = 'calendar-button';
              calendarButton.textContent = 'ğŸ“… Book Now on Google Calendar';
              calendarButton.onclick = function() {
                window.open(googleCalendarUrl, '_blank');
              };
              messagesContainer.appendChild(calendarButton);
              
              // Add back button
              const backButton = document.createElement('button');
              backButton.className = 'back-button';
              backButton.textContent = 'ğŸ”™ Return to Main Menu';
              backButton.onclick = function() {
                handleMenuOption('Main Menu');
              };
              messagesContainer.appendChild(backButton);
              
              messagesContainer.scrollTop = messagesContainer.scrollHeight;
              return;
            case 'ğŸ’¡ About Our Services':
              responseText = `Hereâ€™s what QuickRevert offers ğŸ’¼

âœ¨ AI Automation Solutions â€“ Connect workflows across tools like Google, Slack, and Notion.  

ğŸ™ï¸ Voice AI & Chat Assistants â€“ Deploy WhatsApp, Telegram, or website bots that actually understand.  

ğŸ“… Meeting Automation â€“ Book, update, and manage Google Calendar meetings automatically.  

ğŸ” AI-Powered Search â€“ Find anything across Google Drive, Sheets, or CRM with one query.`;
              newOptions = [
                'ğŸš€ Explore Features in Detail',
                'ğŸ’¬ Talk to an Expert',
                'ğŸ”™ Return to Main Menu'
              ];
              break;
            case 'ğŸ¢ Industry Use Cases':
              responseText = `We help automate workflows across industries ğŸ­  
Choose your industry to see how QuickRevert can help ğŸ‘‡

ğŸ­ Industrial Automation  
ğŸ¥ Healthcare  
ğŸ« Education  
ğŸª Retail & E-commerce  
ğŸ¢ Corporate / Enterprise`;
              newOptions = [
                'ğŸ­ Industrial Automation',
                'ğŸ¥ Healthcare',
                'ğŸ« Education',
                'ğŸª Retail & E-commerce',
                'ğŸ¢ Corporate / Enterprise',
                'ğŸ”™ Return to Main Menu'
              ];
              break;
            case 'ğŸ­ Industrial Automation':
              responseText = `In manufacturing, QuickRevert helps with:
- Predictive maintenance using IoT data  
- Real-time monitoring dashboards  
- Automated reporting & alerts  
- Integration with PLC systems`;
              newOptions = [
                'ğŸ“Š See a Live Case Study',
                'ğŸ”™ Return to Industry Menu'
              ];
              break;
            case 'ğŸ¥ Healthcare':
              responseText = `In healthcare, QuickRevert enables:
- Appointment scheduling automation  
- Secure data handling & reporting  
- Voice-based assistants for patients  
- AI-powered analytics for hospitals`;
              newOptions = [
                'ğŸ¥ See a Hospital Case Study',
                'ğŸ”™ Return to Industry Menu'
              ];
              break;
            case 'ğŸ« Education':
              responseText = `For educational institutes ğŸ“:
- Automate admissions & class scheduling  
- Generate student progress reports  
- AI chatbots for FAQs & guidance  
- Smart reminders for teachers and students`;
              newOptions = [
                'ğŸ“˜ View Education Use Case',
                'ğŸ”™ Return to Industry Menu'
              ];
              break;
            case 'ğŸª Retail & E-commerce':
              responseText = `In retail and e-commerce ğŸ›’:
- AI chatbots for customer engagement  
- Order tracking automation  
- Inventory sync between platforms  
- Personalized recommendations`;
              newOptions = [
                'ğŸ›ï¸ View Retail Case Study',
                'ğŸ”™ Return to Industry Menu'
              ];
              break;
            case 'ğŸ¢ Corporate / Enterprise':
              responseText = `For large organizations ğŸ¢:
- Automate meeting management  
- Integrate multiple apps via one workflow  
- Generate daily analytics summaries  
- Build custom AI dashboards`;
              newOptions = [
                'ğŸ’¼ View Enterprise Solutions',
                'ğŸ”™ Return to Industry Menu'
              ];
              break;
            case 'ğŸ“ˆ Why Businesses Choose QuickRevert':
              responseText = `Hereâ€™s why 100+ teams choose QuickRevert ğŸš€

âœ… No-code automations â€” Launch in hours, not weeks  
âœ… Smart AI Agents â€” Handle repetitive tasks 24/7  
âœ… Scalable â€” Works across apps, industries & teams  
âœ… Customizable â€” We tailor the flow for your business`;
              newOptions = [
                'ğŸ§© See Client Success Stories',
                'ğŸ’¬ Request a Custom Workflow',
                'ğŸ”™ Return to Main Menu'
              ];
              break;
            case 'ğŸ†˜ Get Support or Learn More':
              responseText = `Need help or more info? Hereâ€™s how to reach us ğŸ‘‡

ğŸ’¬ Telegram Support: t.me/QuickRevertSupport  

ğŸ’Œ Email: connectquickrevert@gmail.com`;
              newOptions = [
                'ğŸ™‹â€â™‚ï¸ Talk to Support',
                'ğŸ“š Browse FAQs',
                'ğŸ”™ Return to Main Menu'
              ];
              break;
            case 'ğŸ“š Browse FAQs':
              responseText = `Here are some common questions users ask ğŸ‘‡  \nTap on a topic to view the answer â¤µï¸`;
              newOptions = [
                'â“ What is QuickRevert?',
                'â“ How does QuickRevert integrate with Google Workspace?',
                'â“ Can I connect my WhatsApp or Telegram?',
                'â“ What industries does QuickRevert support?',
                'â“ How secure is my data?',
                'â“ How do I get started?',
                'â“ Can I get a custom automation built?',
                'â“ Where can I contact support?',
                'ğŸ”™ Return to Support Menu'
              ];
              break;
            case 'â“ What is QuickRevert?':
              responseText = `QuickRevert is an AI-powered automation platform that connects your tools like Google, Slack, Notion, and WhatsApp. It helps you book meetings, manage tasks, and automate repetitive workflows â€” all from one place.`;
              newOptions = [
                'ğŸ”™ Return to FAQ Menu'
              ];
              break;
            case 'â“ How does QuickRevert integrate with Google Workspace?':
              responseText = `We integrate directly with your Google Calendar, Drive, Sheets, and Gmail using secure OAuth. You can:  

ğŸ“… Automatically create/update calendar meetings  
ğŸ“Š Sync data from Google Sheets  
ğŸ“‚ Search files with AI  
ğŸ“§ Trigger actions from emails`;
              newOptions = [
                'ğŸ”™ Return to FAQ Menu'
              ];
              break;
            case 'â“ Can I connect my WhatsApp or Telegram?':
              responseText = `âœ… Yes! QuickRevert supports chat-based automation on WhatsApp and Telegram. You can build bots that:  

- Schedule meetings  
- Send reminders  
- Answer FAQs  
- Capture leads`;
              newOptions = [
                'ğŸ”™ Return to FAQ Menu'
              ];
              break;
            case 'â“ What industries does QuickRevert support?':
              responseText = `We work across multiple domains:  

ğŸ­ Manufacturing / Industrial Automation  
ğŸ¥ Healthcare  
ğŸ« Education  
ğŸ›’ Retail / E-commerce  
ğŸ¢ Corporate Enterprises  

You can explore all industry use cases in the Industry Menu above ğŸ‘†`;
              newOptions = [
                'ğŸ”™ Return to FAQ Menu'
              ];
              break;
            case 'â“ How secure is my data?':
              responseText = `ğŸ”’ We use Google OAuth 2.0 for authentication and AES-256 encryption for stored data. All your information stays private â€” we never share or store credentials outside your cloud provider.`;
              newOptions = [
                'ğŸ”™ Return to FAQ Menu'
              ];
              break;
            case 'â“ How do I get started?':
              responseText = `You can start in 3 simple steps ğŸš€  

1ï¸âƒ£ Click Book a Demo  
2ï¸âƒ£ Share your automation requirements  
3ï¸âƒ£ We set up your first workflow in under 24 hours`;
              newOptions = [
                'ğŸ”™ Return to FAQ Menu'
              ];
              break;
            case 'â“ Can I get a custom automation built?':
              responseText = `Yes â€” QuickRevert specializes in custom, AI-driven workflows. You can integrate CRMs, IoT devices, internal apps, or custom APIs. ğŸ’¬ Just message â€œBuild custom automationâ€ and weâ€™ll guide you through it.`;
              newOptions = [
                'ğŸ”™ Return to FAQ Menu'
              ];
              break;
            case 'â“ Where can I contact support?':
              responseText = `ğŸ’¬ Telegram: t.me/QuickRevert_Tech_Bot

ğŸ“§ Email: connectquickrevert@gmail.com 

Weâ€™re available 24/7.`;
              newOptions = [
                'ğŸ”™ Return to FAQ Menu'
              ];
              break;
            case 'ğŸ”™ Return to FAQ Menu':
              // Return to FAQ menu
              responseText = `Here are some common questions users ask ğŸ‘‡  \nTap on a topic to view the answer â¤µï¸`;
              newOptions = [
                'â“ What is QuickRevert?',
                'â“ How does QuickRevert integrate with Google Workspace?',
                'â“ Can I connect my WhatsApp or Telegram?',
                'â“ What industries does QuickRevert support?',
                'â“ How secure is my data?',
                'â“ How do I get started?',
                'â“ Can I get a custom automation built?',
                'â“ Where can I contact support?',
                'ğŸ”™ Return to Support Menu'
              ];
              break;
            case 'ğŸ”™ Return to Industry Menu':
            case 'ğŸ”™ Return to Support Menu':
            case 'Main Menu':
            default:
              // Return to main menu
              responseText = 'Hey ğŸ‘‹ Welcome to QuickRevert Assistant!\n\nHow can I help you today?';
              newOptions = [
                'ğŸ“… Book a Meeting / Demo',
                'ğŸ’¡ About Our Services',
                'ğŸ¢ Industry Use Cases',
                'ğŸ“ˆ Why Businesses Choose QuickRevert',
                'ğŸ†˜ Get Support or Learn More'
              ];
              break;
              // Return to FAQ menu
              responseText = `Here are some common questions users ask ğŸ‘‡  \nTap on a topic to view the answer â¤µï¸`;
              newOptions = [
                'â“ What is QuickRevert?',
                'â“ How does QuickRevert integrate with Google Workspace?',
                'â“ Can I connect my WhatsApp or Telegram?',
                'â“ What industries does QuickRevert support?',
                'â“ How secure is my data?',
                'â“ How do I get started?',
                'â“ Can I get a custom automation built?',
                'â“ Where can I contact support?',
                'ğŸ”™ Return to Support Menu'
              ];
              break;
          }
              
          // Add response message
          const responseElement = document.createElement('div');
          responseElement.className = 'menu-chat-message';
          responseElement.innerHTML = `
            <div class="menu-chat-message__content">
              <div class="menu-chat-message__bubble">
                ${responseText.replace(/\n/g, '<br>')}
              </div>
              <div class="menu-chat-message__timestamp">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
            </div>
          `;
          messagesContainer.appendChild(responseElement);
              
          // Add new options
          const newOptionsContainer = document.createElement('div');
          newOptionsContainer.className = 'menu-options';
          newOptions.forEach((opt, index) => {
            const optionButton = document.createElement('button');
            optionButton.className = 'menu-option';
            optionButton.textContent = opt;
            optionButton.addEventListener('click', function() {
              handleMenuOption(opt);
            });
            newOptionsContainer.appendChild(optionButton);
          });
          messagesContainer.appendChild(newOptionsContainer);
          messagesContainer.scrollTop = messagesContainer.scrollHeight;
        };
        
        // Update the initial menu options to match the new structure
        document.querySelectorAll('.menu-option').forEach(button => {
          button.addEventListener('click', function() {
            const optionText = this.textContent;
            handleMenuOption(optionText);
          });
        });
      });
    </script>
  </body>
</html>